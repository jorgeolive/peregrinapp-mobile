<!DOCTYPE html>
<html>

<head>
    <meta charset='utf-8' />
    <title>MapLibre Test</title>
    <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
    <script src='https://unpkg.com/maplibre-gl@2.4.0/dist/maplibre-gl.js'></script>
    <link href='https://unpkg.com/maplibre-gl@2.4.0/dist/maplibre-gl.css' rel='stylesheet' />
    <style>
        body {
            margin: 0;
            padding: 0;
        }

        #map {
            position: absolute;
            top: 0;
            bottom: 0;
            width: 100%;
        }

        #coordinates {
            position: absolute;
            bottom: 10px;
            right: 10px;
            background: rgba(255, 255, 255, 0.8);
            padding: 5px 10px;
            border-radius: 4px;
            font-family: monospace;
        }
    </style>
</head>

<body>
    <div id='map'></div>
    <div id='coordinates'>Longitude: 0, Latitude: 0</div>
    <script>
        const map = new maplibregl.Map({
            container: 'map',
            style: {
                version: 8,
                glyphs: "https://demotiles.maplibre.org/font/{fontstack}/{range}.pbf",
                sources: {
                    'es-map': {
                        type: 'vector',
                        tiles: ['http://localhost:8080/geoserver/peregrinapp/gwc/service/wmts?REQUEST=GetTile&SERVICE=WMTS&VERSION=1.0.0&LAYER=peregrinapp:es_map&STYLE=&TILEMATRIX=EPSG:900913:{z}&TILEMATRIXSET=EPSG:900913&FORMAT=application/vnd.mapbox-vector-tile&TILECOL={x}&TILEROW={y}'],
                        tms: true
                    },
                    'poblaciones': {
                        type: 'vector',
                        tiles: ['http://localhost:8080/geoserver/peregrinapp/gwc/service/wmts?REQUEST=GetTile&SERVICE=WMTS&VERSION=1.0.0&LAYER=peregrinapp:poblaciones&STYLE=&TILEMATRIX=EPSG:900913:{z}&TILEMATRIXSET=EPSG:900913&FORMAT=application/vnd.mapbox-vector-tile&TILECOL={x}&TILEROW={y}'],
                        tms: true
                    },
                    'camino-norte': {
                        type: 'vector',
                        tiles: ['http://localhost:8080/geoserver/peregrinapp/gwc/service/wmts?REQUEST=GetTile&SERVICE=WMTS&VERSION=1.0.0&LAYER=peregrinapp:camino_norte&STYLE=&TILEMATRIX=EPSG:900913:{z}&TILEMATRIXSET=EPSG:900913&FORMAT=application/vnd.mapbox-vector-tile&TILECOL={x}&TILEROW={y}'],
                        tms: true
                    },
                    'albergues': {
                        type: 'vector',
                        tiles: ['http://localhost:8080/geoserver/peregrinapp/gwc/service/wmts?REQUEST=GetTile&SERVICE=WMTS&VERSION=1.0.0&LAYER=peregrinapp:camino_norte_albergues&STYLE=&TILEMATRIX=EPSG:900913:{z}&TILEMATRIXSET=EPSG:900913&FORMAT=application/vnd.mapbox-vector-tile&TILECOL={x}&TILEROW={y}'],
                        tms: true
                    }
                },
                layers: [
                    {
                        id: 'es-map-fill',
                        type: 'fill',
                        source: 'es-map',
                        'source-layer': 'es_map',
                        paint: {
                            'fill-color': '#627BC1',
                            'fill-opacity': 0.2
                        }
                    },
                    {
                        id: 'es-map-line',
                        type: 'line',
                        source: 'es-map',
                        'source-layer': 'es_map',
                        paint: {
                            'line-color': '#627BC1',
                            'line-width': 1
                        }
                    },
                    {
                        id: 'camino-norte-line',
                        type: 'line',
                        source: 'camino-norte',
                        'source-layer': 'camino_norte',
                        minzoom: 6,
                        paint: {
                            'line-color': '#FF0000',
                            'line-width': 3,
                            'line-opacity': [
                                'interpolate',
                                ['linear'],
                                ['zoom'],
                                5, 0,
                                6, 1
                            ]
                        }
                    },
                    {
                        id: 'poblaciones-points',
                        type: 'circle',
                        source: 'poblaciones',
                        'source-layer': 'poblaciones',
                        minzoom: 8,
                        paint: {
                            'circle-radius': 4,
                            'circle-color': '#FF5722',
                            'circle-stroke-width': 1,
                            'circle-stroke-color': '#ffffff',
                            'circle-opacity': [
                                'interpolate',
                                ['linear'],
                                ['zoom'],
                                8, 0,
                                9, 1
                            ],
                            'circle-stroke-opacity': [
                                'interpolate',
                                ['linear'],
                                ['zoom'],
                                8, 0,
                                9, 1
                            ]
                        }
                    },
                    {
                        id: 'poblaciones-labels',
                        type: 'symbol',
                        source: 'poblaciones',
                        'source-layer': 'poblaciones',
                        minzoom: 8,
                        layout: {
                            'text-field': ['get', 'etiqueta'],
                            'text-anchor': 'left',
                            'text-offset': [0.5, 0],
                            'text-size': 12,
                            'text-font': ['Noto Sans Regular']
                        },
                        paint: {
                            'text-color': '#333',
                            'text-halo-color': '#fff',
                            'text-halo-width': 2,
                            'text-opacity': [
                                'interpolate',
                                ['linear'],
                                ['zoom'],
                                8, 0,
                                9, 1
                            ]
                        }
                    },
                    {
                        id: 'albergues-points',
                        type: 'circle',
                        source: 'albergues',
                        'source-layer': 'camino_norte_albergues',
                        minzoom: 6,
                        paint: {
                            'circle-radius': 6,
                            'circle-color': '#4CAF50',
                            'circle-stroke-width': 2,
                            'circle-stroke-color': '#ffffff',
                            'circle-opacity': [
                                'interpolate',
                                ['linear'],
                                ['zoom'],
                                5, 0,
                                6, 1
                            ],
                            'circle-stroke-opacity': [
                                'interpolate',
                                ['linear'],
                                ['zoom'],
                                5, 0,
                                6, 1
                            ]
                        }
                    },
                    {
                        id: 'albergues-labels',
                        type: 'symbol',
                        source: 'albergues',
                        'source-layer': 'camino_norte_albergues',
                        minzoom: 11,
                        layout: {
                            'text-field': ['get', 'name'],
                            'text-anchor': 'left',
                            'text-offset': [0.7, 0],
                            'text-size': 14,
                            'text-font': ['Noto Sans Regular']
                        },
                        paint: {
                            'text-color': '#1B5E20',
                            'text-halo-color': '#fff',
                            'text-halo-width': 2,
                            'text-opacity': [
                                'interpolate',
                                ['linear'],
                                ['zoom'],
                                5, 0,
                                6, 1
                            ]
                        }
                    }
                ]
            },
            center: [-3.7492, 40.4637],
            zoom: 6,
            maxBounds: [
                [-9.4, 36.0],
                [4.4, 43.8]
            ]
        });

        // Add coordinates display
        map.on('mousemove', function(e) {
            document.getElementById('coordinates').innerHTML = 
                `Longitude: ${e.lngLat.lng.toFixed(4)}, Latitude: ${e.lngLat.lat.toFixed(4)}`;
        });

        // Add navigation controls
        map.addControl(new maplibregl.NavigationControl());
    </script>
</body>

</html>